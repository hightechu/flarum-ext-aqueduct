{"version":3,"sources":["webpack://@flagrow/aqueduct/webpack/bootstrap","webpack://@flagrow/aqueduct/./forum.js","webpack://@flagrow/aqueduct/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@flagrow/aqueduct/./node_modules/html5sortable/dist/html.sortable.js","webpack://@flagrow/aqueduct/./src/forum/addsBoardToDiscussion.js","webpack://@flagrow/aqueduct/./src/forum/components/Card.js","webpack://@flagrow/aqueduct/./src/forum/components/Column.js","webpack://@flagrow/aqueduct/./src/forum/index.js","webpack://@flagrow/aqueduct/./src/forum/modals/AddColumnModal.js","webpack://@flagrow/aqueduct/./src/forum/pages/Board.js","webpack://@flagrow/aqueduct/./src/forum/routes.js","webpack://@flagrow/aqueduct/external \"flarum.core.compat['Component']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['Model']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['components/Button']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['components/DiscussionPage']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['components/Modal']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['components/Page']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['components/SplitDropdown']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['extend']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['helpers/avatar']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['helpers/highlight']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['helpers/icon']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['models/Discussion']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['tags/helpers/tagIcon']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['tags/helpers/tagLabel']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['tags/models/Tag']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['utils/ItemList']\"","webpack://@flagrow/aqueduct/external \"flarum.core.compat['utils/classList']\""],"names":["extend","DiscussionPage","prototype","items","discussion","tags","filter","tag","position","isChild","controls","ItemList","canAccessBoard","canUseBoard","canManageBoard","forEach","add","slug","Button","component","children","app","translator","trans","name","icon","onclick","m","route","length","SplitDropdown","toArray","className","buttonClassName","Card","init","props","isUnread","view","jumpTo","Math","min","lastPostNumber","lastReadPostNumber","id","title","footerControls","user","element","$","tooltip","placement","apply","arguments","avatar","Component","Column","board","discussions","loading","dragging","draggingEnabled","draggable","sorted","ready","sortable","color","style","description","isEmpty","map","confirm","delete","selector","connectWith","placeholder","forcePlaceholderSize","addEventListener","e","target","attr","detail","endparent","sorting","find","get","updateDiscussionSorting","console","debug","column","request","method","url","forum","attribute","then","results","store","pushPayload","redraw","getBy","getById","data","relationships","t","indexOf","push","save","initializers","Tag","Model","columns","hasMany","boardSort","boardMaxItems","Discussion","assignedUsers","assignedGroups","routes","addsBoardToDiscussion","AddColumnModal","for","all","selected","prop","index","focused","content","toLowerCase","parent","substr","onready","tagLabel","withAttr","type","disabled","classList","pinned","child","colored","active","tagIcon","highlight","onsubmit","preventDefault","modal","close","strategy","Modal","Board","bodyClass","refresh","config","isInitialized","context","setTitle","setTitleCount","setDraggable","show","clear","param","sort","a","b","load","parseResults","lazyRedraw","handle","updateColumnSorting","Page","path"],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAA,wC;;;;;;;;;;;;ACAA;AAAA;AAAe;AACf;AACA;AACA;AACA,C;;;;;;;;;;;ACJA,iGAAC;AACD,MAAM,IAA0C;AAChD,IAAI,iCAAO,EAAE,oCAAE,OAAO;AAAA;AAAA;AAAA,oGAAC;AACvB,GAAG,MAAM,EAIN;AACH,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,GAAG;AACd,WAAW,SAAS;AACpB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,aAAa;AACxB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,aAAa;AACxB,WAAW,SAAS;AACpB;AACA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,aAAa;AACxB;AACA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,WAAW,EAAE;AACb;AACA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB;AACA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,YAAY;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,WAAW,GAAG;AACd,WAAW,MAAM;AACjB,WAAW,QAAQ;AACnB,aAAa,SAAS;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,cAAc;AACzB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/forum';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}",";(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.sortable = factory();\n  }\n}(this, function() {\n/*\n * HTML5 Sortable library\n * https://github.com/lukasoppermann/html5sortable\n *\n * Original code copyright 2012 Ali Farhadi.\n * This version is mantained by Lukas Oppermann <lukas@vea.re>\n * Previously also mantained by Alexandru Badiu <andu@ctrlz.ro>\n * jQuery-independent implementation by Nazar Mokrynskyi <nazar@mokrynskyi.com>\n *\n * Released under the MIT license.\n */\n'use strict'\n/*\n * variables global to the plugin\n */\nvar dragging\nvar draggingHeight\nvar placeholders = []\nvar sortables = []\n/**\n * Get or set data on element\n * @param {Element} element\n * @param {string} key\n * @param {*} value\n * @return {*}\n */\nvar _data = function (element, key, value) {\n  if (value === undefined) {\n    return element && element.h5s && element.h5s.data && element.h5s.data[key]\n  } else {\n    element.h5s = element.h5s || {}\n    element.h5s.data = element.h5s.data || {}\n    element.h5s.data[key] = value\n  }\n}\n/**\n * Remove data from element\n * @param {Element} element\n */\nvar _removeData = function (element) {\n  if (element.h5s) {\n    delete element.h5s.data\n  }\n}\n/**\n * Tests if an element matches a given selector. Comparable to jQuery's $(el).is('.my-class')\n * @param {el} DOM element\n * @param {selector} selector test against the element\n * @returns {boolean}\n */\n/* istanbul ignore next */\nvar _matches = function (el, selector) {\n  return (el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector).call(el, selector)\n}\n/**\n * Filter only wanted nodes\n * @param {Array|NodeList} nodes\n * @param {Array/string} wanted\n * @returns {Array}\n */\nvar _filter = function (nodes, wanted) {\n  if (!wanted) {\n    return Array.prototype.slice.call(nodes)\n  }\n  var result = []\n  for (var i = 0; i < nodes.length; ++i) {\n    if (typeof wanted === 'string' && _matches(nodes[i], wanted)) {\n      result.push(nodes[i])\n    }\n    if (wanted.indexOf(nodes[i]) !== -1) {\n      result.push(nodes[i])\n    }\n  }\n  return result\n}\n/**\n * @param {Array|Element} element\n * @param {Array|string} event\n * @param {Function} callback\n */\nvar _on = function (element, event, callback) {\n  if (element instanceof Array) {\n    for (var i = 0; i < element.length; ++i) {\n      _on(element[i], event, callback)\n    }\n    return\n  }\n  element.addEventListener(event, callback)\n  element.h5s = element.h5s || {}\n  element.h5s.events = element.h5s.events || {}\n  element.h5s.events[event] = callback\n}\n/**\n * @param {Array|Element} element\n * @param {Array|string} event\n */\nvar _off = function (element, event) {\n  if (element instanceof Array) {\n    for (var i = 0; i < element.length; ++i) {\n      _off(element[i], event)\n    }\n    return\n  }\n  if (element.h5s && element.h5s.events && element.h5s.events[event]) {\n    element.removeEventListener(event, element.h5s.events[event])\n    delete element.h5s.events[event]\n  }\n}\n/**\n * @param {Array|Element} element\n * @param {string} attribute\n * @param {*} value\n */\nvar _attr = function (element, attribute, value) {\n  if (element instanceof Array) {\n    for (var i = 0; i < element.length; ++i) {\n      _attr(element[i], attribute, value)\n    }\n    return\n  }\n  element.setAttribute(attribute, value)\n}\n/**\n * @param {Array|Element} element\n * @param {string} attribute\n */\nvar _removeAttr = function (element, attribute) {\n  if (element instanceof Array) {\n    for (var i = 0; i < element.length; ++i) {\n      _removeAttr(element[i], attribute)\n    }\n    return\n  }\n  element.removeAttribute(attribute)\n}\n/**\n * @param {Element} element\n * @returns {{left: *, top: *}}\n */\nvar _offset = function (element) {\n  var rect = element.getClientRects()[0]\n  return {\n    left: rect.left + window.scrollX,\n    top: rect.top + window.scrollY\n  }\n}\n/*\n * remove event handlers from items\n * @param {Array|NodeList} items\n */\nvar _removeItemEvents = function (items) {\n  _off(items, 'dragstart')\n  _off(items, 'dragend')\n  _off(items, 'selectstart')\n  _off(items, 'dragover')\n  _off(items, 'dragenter')\n  _off(items, 'drop')\n}\n/*\n * Remove event handlers from sortable\n * @param {Element} sortable a single sortable\n */\nvar _removeSortableEvents = function (sortable) {\n  _off(sortable, 'dragover')\n  _off(sortable, 'dragenter')\n  _off(sortable, 'drop')\n}\n/*\n * Attach ghost to dataTransfer object\n * @param {Event} original event\n * @param {object} ghost-object with item, x and y coordinates\n */\nvar _attachGhost = function (event, ghost) {\n  // this needs to be set for HTML5 drag & drop to work\n  event.dataTransfer.effectAllowed = 'move'\n  // Firefox requires some arbitrary content in the data in order for\n  // the drag & drop functionality to work\n  event.dataTransfer.setData('text', 'arbitrary-content')\n\n  // check if setDragImage method is available\n  if (event.dataTransfer.setDragImage) {\n    event.dataTransfer.setDragImage(ghost.draggedItem, ghost.x, ghost.y)\n  }\n}\n/**\n * _addGhostPos clones the dragged item and adds it as a Ghost item\n * @param {Event} event - the event fired when dragstart is triggered\n * @param {object} ghost - .draggedItem = Element\n */\nvar _addGhostPos = function (event, ghost) {\n  if (!ghost.x) {\n    ghost.x = parseInt(event.pageX - _offset(ghost.draggedItem).left)\n  }\n  if (!ghost.y) {\n    ghost.y = parseInt(event.pageY - _offset(ghost.draggedItem).top)\n  }\n  return ghost\n}\n/**\n * _makeGhost decides which way to make a ghost and passes it to attachGhost\n * @param {Element} draggedItem - the item that the user drags\n */\nvar _makeGhost = function (draggedItem) {\n  return {\n    draggedItem: draggedItem\n  }\n}\n/**\n * _getGhost constructs ghost and attaches it to dataTransfer\n * @param {Event} event - the original drag event object\n * @param {Element} draggedItem - the item that the user drags\n */\n// TODO: could draggedItem be replaced by event.target in all instances\nvar _getGhost = function (event, draggedItem) {\n  // add ghost item & draggedItem to ghost object\n  var ghost = _makeGhost(draggedItem)\n  // attach ghost position\n  ghost = _addGhostPos(event, ghost)\n  // attach ghost to dataTransfer\n  _attachGhost(event, ghost)\n}\n/*\n * Remove data from sortable\n * @param {Element} sortable a single sortable\n */\nvar _removeSortableData = function (sortable) {\n  _removeData(sortable)\n  _removeAttr(sortable, 'aria-dropeffect')\n}\n/*\n * Remove data from items\n * @param {Array|Element} items\n */\nvar _removeItemData = function (items) {\n  _removeAttr(items, 'aria-grabbed')\n  _removeAttr(items, 'draggable')\n  _removeAttr(items, 'role')\n}\n/*\n * Check if two lists are connected\n * @param {Element} curList\n * @param {Element} destList\n */\nvar _listsConnected = function (curList, destList) {\n  if (curList === destList) {\n    return true\n  }\n  if (_data(curList, 'connectWith') !== undefined) {\n    return _data(curList, 'connectWith') === _data(destList, 'connectWith')\n  }\n  return false\n}\n/*\n * get handle or return item\n * @param {Array} items\n * @param {selector} handle\n */\nvar _getHandles = function (items, handle) {\n  var result = []\n  var handles\n  if (!handle) {\n    return items\n  }\n  for (var i = 0; i < items.length; ++i) {\n    handles = items[i].querySelectorAll(handle)\n    result = result.concat(Array.prototype.slice.call(handles))\n  }\n  return result\n}\n/*\n * Destroy the sortable\n * @param {Element} sortableElement a single sortable\n */\nvar _destroySortable = function (sortableElement) {\n  var opts = _data(sortableElement, 'opts') || {}\n  var items = _filter(_getChildren(sortableElement), opts.items)\n  var handles = _getHandles(items, opts.handle)\n  // remove event handlers & data from sortable\n  _removeSortableEvents(sortableElement)\n  _removeSortableData(sortableElement)\n  // remove event handlers & data from items\n  _off(handles, 'mousedown')\n  _removeItemEvents(items)\n  _removeItemData(items)\n}\n/*\n * Enable the sortable\n * @param {Element} sortableElement a single sortable\n */\nvar _enableSortable = function (sortableElement) {\n  var opts = _data(sortableElement, 'opts')\n  var items = _filter(_getChildren(sortableElement), opts.items)\n  var handles = _getHandles(items, opts.handle)\n  _attr(sortableElement, 'aria-dropeffect', 'move')\n  _data(sortableElement, '_disabled', 'false')\n  _attr(handles, 'draggable', 'true')\n  // IE FIX for ghost\n  // can be disabled as it has the side effect that other events\n  // (e.g. click) will be ignored\n  var spanEl = (document || window.document).createElement('span')\n  if (typeof spanEl.dragDrop === 'function' && !opts.disableIEFix) {\n    _on(handles, 'mousedown', function () {\n      if (items.indexOf(this) !== -1) {\n        this.dragDrop()\n      } else {\n        var parent = this.parentElement\n        while (items.indexOf(parent) === -1) {\n          parent = parent.parentElement\n        }\n        parent.dragDrop()\n      }\n    })\n  }\n}\n/*\n * Disable the sortable\n * @param {Element} sortableElement a single sortable\n */\nvar _disableSortable = function (sortableElement) {\n  var opts = _data(sortableElement, 'opts')\n  var items = _filter(_getChildren(sortableElement), opts.items)\n  var handles = _getHandles(items, opts.handle)\n  _attr(sortableElement, 'aria-dropeffect', 'none')\n  _data(sortableElement, '_disabled', 'true')\n  _attr(handles, 'draggable', 'false')\n  _off(handles, 'mousedown')\n}\n/*\n * Reload the sortable\n * @param {Element} sortableElement a single sortable\n * @description events need to be removed to not be double bound\n */\nvar _reloadSortable = function (sortableElement) {\n  var opts = _data(sortableElement, 'opts')\n  var items = _filter(_getChildren(sortableElement), opts.items)\n  var handles = _getHandles(items, opts.handle)\n  _data(sortableElement, '_disabled', 'false')\n  // remove event handlers from items\n  _removeItemEvents(items)\n  _off(handles, 'mousedown')\n  // remove event handlers from sortable\n  _removeSortableEvents(sortableElement)\n}\n/**\n * Get position of the element relatively to its sibling elements\n * @param {Element} element\n * @returns {number}\n */\nvar _index = function (element) {\n  if (!element.parentElement) {\n    return 0\n  }\n  return Array.prototype.indexOf.call(element.parentElement.children, element)\n}\n/**\n * Whether element is in DOM\n * @param {Element} element\n * @returns {boolean}\n */\nvar _attached = function (element) {\n  // document.body.contains(element)\n  return !!element.parentNode\n}\n/**\n * Convert HTML string into DOM element.\n * @param {Element|string} html\n * @param {string} tagname\n * @returns {Element}\n */\nvar _html2element = function (html, tagName) {\n  if (typeof html !== 'string') {\n    return html\n  }\n  var parentElement = document.createElement(tagName)\n  parentElement.innerHTML = html\n  return parentElement.firstChild\n}\n/**\n * Insert before target\n * @param {Element} target\n * @param {Element} element\n */\nvar _before = function (target, element) {\n  target.parentElement.insertBefore(\n    element,\n    target\n  )\n}\n/**\n * Insert after target\n * @param {Element} target\n * @param {Element} element\n */\nvar _after = function (target, element) {\n  target.parentElement.insertBefore(\n    element,\n    target.nextElementSibling\n  )\n}\n/**\n * Detach element from DOM\n * @param {Element} element\n */\nvar _detach = function (element) {\n  if (element.parentNode) {\n    element.parentNode.removeChild(element)\n  }\n}\n/**\n * Make native event that can be dispatched afterwards\n * @param {string} name\n * @param {object} detail\n * @returns {CustomEvent}\n */\nvar _makeEvent = function (name, detail) {\n  var e = document.createEvent('Event')\n  if (detail) {\n    e.detail = detail\n  }\n  e.initEvent(name, false, true)\n  return e\n}\n/**\n * @param {Element} sortableElement\n * @param {CustomEvent} event\n */\nvar _dispatchEventOnConnected = function (sortableElement, event) {\n  sortables.forEach(function (target) {\n    if (_listsConnected(sortableElement, target)) {\n      target.dispatchEvent(event)\n    }\n  })\n}\n\n/**\n * Creates and returns a new debounced version of the passed function which will postpone its execution until after wait milliseconds have elapsed\n * @param {fn} Function to debounce\n * @param {delay} time to wait before calling function with latest arguments, 0 - no debounce\n * @param {context} time to wait before calling function with latest arguments, 0 - no debounce\n * @returns {function} - debounced function\n */\nfunction _debounce (fn, delay, context) {\n  var timer = null\n\n  if (delay === 0) {\n    return fn\n  }\n  return function () {\n    var eContext = context || this\n    var args = arguments\n    clearTimeout(timer)\n    timer = setTimeout(function () {\n      fn.apply(eContext, args)\n    }, delay)\n  }\n}\n\nvar _getChildren = function (element) {\n  return element.children\n}\n\nvar _serialize = function (list) {\n  var children = _filter(_getChildren(list), _data(list, 'items'))\n  return children\n}\n\n/*\n * Public sortable object\n * @param {Array|NodeList} sortableElements\n * @param {object|string} options|method\n */\nvar sortable = function (sortableElements, options) {\n  var method = String(options)\n\n  options = (function (options) {\n    var result = {\n      connectWith: false,\n      placeholder: null,\n      disableIEFix: false,\n      placeholderClass: 'sortable-placeholder',\n      draggingClass: 'sortable-dragging',\n      hoverClass: false,\n      debounce: 0,\n      maxItems: 0\n    }\n    for (var option in options) {\n      result[option] = options[option]\n    }\n    return result\n  })(options)\n\n  if (options && typeof options.getChildren === 'function') {\n    _getChildren = options.getChildren\n  }\n\n  if (typeof sortableElements === 'string') {\n    sortableElements = document.querySelectorAll(sortableElements)\n  }\n\n  if (sortableElements instanceof window.Element) {\n    sortableElements = [sortableElements]\n  }\n\n  sortableElements = Array.prototype.slice.call(sortableElements)\n\n  if (/serialize/.test(method)) {\n    var serialized = []\n    sortableElements.forEach(function (sortableElement) {\n      serialized.push({\n        list: sortableElement,\n        children: _serialize(sortableElement)\n      })\n    })\n    return serialized\n  }\n\n  /* TODO: maxstatements should be 25, fix and remove line below */\n  /* jshint maxstatements:false */\n  sortableElements.forEach(function (sortableElement) {\n    if (/enable|disable|destroy/.test(method)) {\n      return sortable[method](sortableElement)\n    }\n\n    // get options & set options on sortable\n    options = _data(sortableElement, 'opts') || options\n    _data(sortableElement, 'opts', options)\n    // reset sortable\n    _reloadSortable(sortableElement)\n    // initialize\n    var items = _filter(_getChildren(sortableElement), options.items)\n    var index\n    var startParent\n    var startList\n    var placeholder = options.placeholder\n    var maxItems\n    if (!placeholder) {\n      placeholder = document.createElement(\n        /^ul|ol$/i.test(sortableElement.tagName) ? 'li' : 'div'\n      )\n    }\n    placeholder = _html2element(placeholder, sortableElement.tagName)\n    placeholder.classList.add.apply(\n      placeholder.classList,\n      options.placeholderClass.split(' ')\n    )\n\n    // setup sortable ids\n    if (!sortableElement.getAttribute('data-sortable-id')) {\n      var id = sortables.length\n      sortables[id] = sortableElement\n      _attr(sortableElement, 'data-sortable-id', id)\n      _attr(items, 'data-item-sortable-id', id)\n    }\n\n    _data(sortableElement, 'items', options.items)\n    placeholders.push(placeholder)\n    if (options.connectWith) {\n      _data(sortableElement, 'connectWith', options.connectWith)\n    }\n\n    _enableSortable(sortableElement)\n    _attr(items, 'role', 'option')\n    _attr(items, 'aria-grabbed', 'false')\n\n    // Mouse over class\n    if (options.hoverClass) {\n      var hoverClass = 'sortable-over'\n      if (typeof options.hoverClass === 'string') {\n        hoverClass = options.hoverClass\n      }\n\n      _on(items, 'mouseenter', function () {\n        this.classList.add(hoverClass)\n      })\n      _on(items, 'mouseleave', function () {\n        this.classList.remove(hoverClass)\n      })\n    }\n\n    // max items\n    if (options.maxItems && typeof options.maxItems === 'number') {\n      maxItems = options.maxItems\n    }\n\n    // Handle drag events on draggable items\n    _on(items, 'dragstart', function (e) {\n      e.stopImmediatePropagation()\n      if ((options.handle && !_matches(e.target, options.handle)) || this.getAttribute('draggable') === 'false') {\n        return\n      }\n\n      // add transparent clone or other ghost to cursor\n      _getGhost(e, this)\n      // cache selsection & add attr for dragging\n      this.classList.add(options.draggingClass)\n      dragging = this\n      _attr(dragging, 'aria-grabbed', 'true')\n      // grab values\n      index = _index(dragging)\n      draggingHeight = parseInt(window.getComputedStyle(dragging).height)\n      startParent = this.parentElement\n      startList = _serialize(startParent)\n      // dispatch sortstart event on each element in group\n      _dispatchEventOnConnected(sortableElement, _makeEvent('sortstart', {\n        item: dragging,\n        placeholder: placeholder,\n        startparent: startParent\n      }))\n    })\n    // Handle drag events on draggable items\n    _on(items, 'dragend', function () {\n      var newParent\n      if (!dragging) {\n        return\n      }\n      // remove dragging attributes and show item\n      dragging.classList.remove(options.draggingClass)\n      _attr(dragging, 'aria-grabbed', 'false')\n      dragging.style.display = dragging.oldDisplay\n      delete dragging.oldDisplay\n\n      placeholders.forEach(_detach)\n      newParent = this.parentElement\n      _dispatchEventOnConnected(sortableElement, _makeEvent('sortstop', {\n        item: dragging,\n        startparent: startParent\n      }))\n      if (index !== _index(dragging) || startParent !== newParent) {\n        _dispatchEventOnConnected(sortableElement, _makeEvent('sortupdate', {\n          item: dragging,\n          index: _filter(_getChildren(newParent), _data(newParent, 'items'))\n              .indexOf(dragging),\n          oldindex: items.indexOf(dragging),\n          elementIndex: _index(dragging),\n          oldElementIndex: index,\n          startparent: startParent,\n          endparent: newParent,\n          newEndList: _serialize(newParent),\n          newStartList: _serialize(startParent),\n          oldStartList: startList\n        }))\n      }\n      dragging = null\n      draggingHeight = null\n    })\n    // Handle drop event on sortable & placeholder\n    // TODO: REMOVE placeholder?????\n    _on([sortableElement, placeholder], 'drop', function (e) {\n      var visiblePlaceholder\n      if (!_listsConnected(sortableElement, dragging.parentElement)) {\n        return\n      }\n\n      e.preventDefault()\n      e.stopPropagation()\n      visiblePlaceholder = placeholders.filter(_attached)[0]\n      _after(visiblePlaceholder, dragging)\n      dragging.dispatchEvent(_makeEvent('dragend'))\n    })\n\n    var debouncedDragOverEnter = _debounce(function (element, pageY) {\n      if (!dragging) {\n        return\n      }\n\n      if (items.indexOf(element) !== -1) {\n        var thisHeight = parseInt(window.getComputedStyle(element).height)\n        var placeholderIndex = _index(placeholder)\n        var thisIndex = _index(element)\n        if (options.forcePlaceholderSize) {\n          placeholder.style.height = draggingHeight + 'px'\n        }\n\n        // Check if `element` is bigger than the draggable. If it is, we have to define a dead zone to prevent flickering\n        if (thisHeight > draggingHeight) {\n          // Dead zone?\n          var deadZone = thisHeight - draggingHeight\n          var offsetTop = _offset(element).top\n          if (placeholderIndex < thisIndex &&\n              pageY < offsetTop + deadZone) {\n            return\n          }\n          if (placeholderIndex > thisIndex &&\n              pageY > offsetTop + thisHeight - deadZone) {\n            return\n          }\n        }\n\n        if (dragging.oldDisplay === undefined) {\n          dragging.oldDisplay = dragging.style.display\n        }\n\n        if (dragging.style.display !== 'none') {\n          dragging.style.display = 'none'\n        }\n\n        if (placeholderIndex < thisIndex) {\n          _after(element, placeholder)\n        } else {\n          _before(element, placeholder)\n        }\n        // Intentionally violated chaining, it is more complex otherwise\n        placeholders\n          .filter(function (element) { return element !== placeholder })\n          .forEach(_detach)\n      } else {\n        if (placeholders.indexOf(element) === -1 &&\n            !_filter(_getChildren(element), options.items).length) {\n          placeholders.forEach(_detach)\n          element.appendChild(placeholder)\n        }\n      }\n    }, options.debounce)\n\n    // Handle dragover and dragenter events on draggable items\n    var onDragOverEnter = function (e) {\n      if (!dragging || !_listsConnected(sortableElement, dragging.parentElement) || _data(sortableElement, '_disabled') === 'true') {\n        return\n      }\n      if (maxItems && _filter(_getChildren(sortableElement), _data(sortableElement, 'items')).length >= maxItems) {\n        return\n      }\n      e.preventDefault()\n      e.stopPropagation()\n      e.dataTransfer.dropEffect = 'move'\n      debouncedDragOverEnter(this, e.pageY)\n    }\n\n    _on(items.concat(sortableElement), 'dragover', onDragOverEnter)\n    _on(items.concat(sortableElement), 'dragenter', onDragOverEnter)\n  })\n\n  return sortableElements\n}\n\nsortable.destroy = function (sortableElement) {\n  _destroySortable(sortableElement)\n}\n\nsortable.enable = function (sortableElement) {\n  _enableSortable(sortableElement)\n}\n\nsortable.disable = function (sortableElement) {\n  _disableSortable(sortableElement)\n}\n\n\nreturn sortable;\n}));\n","import {extend} from \"flarum/extend\";\nimport DiscussionPage from \"flarum/components/DiscussionPage\";\nimport Button from \"flarum/components/Button\";\nimport SplitDropdown from \"flarum/components/SplitDropdown\";\nimport ItemList from \"flarum/utils/ItemList\";\n\nexport default function () {\n\n    // Add a control allowing direct visiting of the board.\n    extend(DiscussionPage.prototype, 'sidebarItems', function (items) {\n        const discussion = this.discussion;\n        let tags = discussion.tags().filter(tag => tag.position() !== null && !tag.isChild());\n\n        let controls = new ItemList;\n\n        tags = tags.filter(tag => tag.canAccessBoard() || tag.canUseBoard() || tag.canManageBoard());\n\n        tags.forEach(tag => {\n            controls.add('board-' + tag.slug(), Button.component({\n                children: app.translator.trans('flagrow-aqueduct.forum.discussion.buttons.show-board', {tag: tag.name()}),\n                icon: 'fab fa-trello',\n                onclick: () => m.route(app.route('flagrow.kanban.board', {tag: tag.slug()}))\n            }));\n        })\n\n        if (tags.length > 0) {\n            items.add(\n                'board',\n                SplitDropdown.component({\n                    children: controls.toArray(),\n                    icon: 'fab fa-trello',\n                    className: 'App-primaryControl',\n                    buttonClassName: 'Button--secondary'\n                }),\n                -50\n            );\n        }\n    });\n}\n","import Component from 'flarum/Component';\nimport ItemList from 'flarum/utils/ItemList';\nimport icon from 'flarum/helpers/icon';\nimport avatar from 'flarum/helpers/avatar';\n\nexport default class Card extends Component {\n    init() {\n        this.discussion = this.props.discussion;\n        this.isUnread = this.discussion.isUnread();\n    }\n\n    view() {\n        const jumpTo = Math.min(this.discussion.lastPostNumber(), (this.discussion.lastReadPostNumber() || 0) + 1);\n\n        return m('div', {\n            className: 'Card' + (this.isUnread ? ' Unread' : ''),\n            discussion: this.discussion.id()\n        }, m('div', {className: 'Card--Handle'}, [\n            m('div', {className: 'Card--Header'}, [\n                // Issue title.\n                m('div', {className: 'Card--Title'},\n                    <a href={app.route.discussion(this.discussion, jumpTo)}\n                       config={m.route}>\n                        {this.discussion.title()}\n                    </a>\n                )\n            ]),\n            m('div', {className: 'Card--Footer'}, this.footerControls().toArray())\n        ]))\n    }\n\n    footerControls() {\n        let items = new ItemList;\n\n        const user = this.discussion.user();\n\n        items.add('user',\n            <a href={user ? app.route.user(user) : '#'}\n              className=\"Card--Author\"\n              config={function(element) {\n                  $(element).tooltip({placement: 'right'});\n                  m.route.apply(this, arguments);\n              }}>\n            {avatar(user, {title: ''})}\n        </a>);\n\n        items.add('count', m('div', {className: 'Card--Replies-Count'}, [\n            icon(this.isUnread ? 'commenting-o' : 'comment-o'),\n            this.discussion[this.isUnread ? 'unreadCount' : 'replyCount']()\n        ]));\n\n        return items;\n    }\n}\n","import Component from 'flarum/Component';\nimport SplitDropdown from 'flarum/components/SplitDropdown';\nimport Button from 'flarum/components/Button';\nimport ItemList from 'flarum/utils/ItemList';\nimport Card from '../components/Card';\nimport sortable from \"html5sortable\";\n\n\nexport default class Column extends Component {\n    init() {\n        this.board = this.props.board;\n        this.tag = this.props.tag;\n        this.discussions = this.props.discussions;\n        this.loading = this.props.loading;\n        this.dragging = this.props.dragging;\n        this.draggingEnabled = this.props.draggable === 'cards';\n        this.tags = this.props.tags;\n        this.sorted = [];\n\n        this.$().ready(() => {\n            this.sortable();\n        });\n    }\n\n    view() {\n        const tag = this.tag;\n\n        return m('div', {\n            className: 'Board--Column ' + tag.name(),\n            slug: tag.slug()\n        }, [\n            m('div', {className: 'Board--Inner'}, [\n                m('header', {\n                    className: 'Board--Header' + (tag.color() ? ' colored' : ''),\n                    style: tag.color() ? 'border-top-color: ' + tag.color() + ';' : ''\n                }, m('h4', [\n                    tag.name(),\n                    m('span', tag.description()),\n\n                    this.controls().isEmpty() ? [] :\n                        SplitDropdown.component({\n                            children: this.controls().toArray(),\n                            icon: 'ellipsis-v',\n                            buttonClassName: 'Button'\n                        })\n                ])),\n                m('div', {\n                    className: 'Board--Item-List',\n                    slug: tag.slug()\n                }, this.loading || this.discussions.length == 0 ? '' : this.discussions.map(discussion => {\n                    return Card.component({discussion});\n                }))\n            ])\n        ]);\n    }\n\n    controls() {\n        const tag = this.tag;\n        let items = new ItemList;\n\n        if (this.draggable === 'columns' && tag.canManageBoard()) {\n            items.add('remove-column', Button.component({\n                icon: 'fas fa-cog',\n                children: app.translator.trans('flagrow-aqueduct.forum.board.buttons.remove-column'),\n                onclick: () => {\n                    if (confirm(app.translator.trans('flagrow-aqueduct.forum.board.buttons.remove-column-confirmation', {tag: tag.name()}))) {\n                        this.delete();\n                    }\n                }\n            }));\n        }\n\n        return items;\n    }\n\n    sortable() {\n        const selector = '.Board--Item-List[slug=' + this.tag.slug() + ']';\n\n        if (!this.dragging && this.draggingEnabled && this.sorted.length === 0) {\n            this.sorted = sortable(selector, {\n                connectWith: '.Board--Item-List',\n                items: '.Card',\n                // handle: '.Card--Header',\n                placeholder: '<div class=\"Card Placeholder\"></div>',\n                forcePlaceholderSize: true\n            });\n\n            this.sorted[0].addEventListener('sortupdate', (e) => {\n                const tag = $(e.target).attr('slug');\n                // prevents updating multiple times\n                if (tag === $(e.detail.endparent).attr('slug')) {\n                    const sorting = $(e.target).find('.Card').map(function () {\n                        return $(this).attr('discussion');\n                    }).get();\n\n                    this.updateDiscussionSorting(sorting, tag);\n                }\n            });\n\n            console.debug('Readied up sorting for ' + this.tag.name());\n        } else if (this.draggingEnabled) {\n            sortable(selector);\n        }\n\n        this.dragging = (this.dragging === null && this.sorted.length > 0) || this.dragging !== null;\n    }\n\n    delete() {\n        const board = this.board;\n        const column = this.tag;\n\n        app.request({\n            method: 'DELETE',\n            url: app.forum.attribute('apiUrl') + '/board/' + board.slug() + '/columns/' + column.slug(),\n        }).then(results => {\n            this.tag = app.store.pushPayload(results);\n\n            m.redraw();\n        });\n    }\n\n    updateDiscussionSorting(sorting, slug) {\n        const tag = app.store.getBy('tags', 'slug', slug);\n\n        if (sorting.length > 0) {\n            sorting.forEach(id => {\n                const discussion = app.store.getById('discussions', id);\n                const tags = discussion.tags();\n\n                const data = {\n                    relationships: {\n                        tags: []\n                    }\n                }\n\n                // drop all tags from discussion that are part of this board as column\n                tags.forEach(t => {\n                    if (this.tags.indexOf(t) < 0 && t.id() !== tag.id()) {\n                        data.relationships.tags.push(t);\n                    }\n                })\n\n                // then re-add that tag so it can be saved\n                data.relationships.tags.push(tag);\n\n                discussion.save(data);\n            })\n        }\n    }\n}\n","import routes from './routes';\nimport addsBoardToDiscussion from './addsBoardToDiscussion';\n\nimport Model from 'flarum/Model';\nimport Tag from 'flarum/tags/models/Tag';\nimport Discussion from 'flarum/models/Discussion';\n\napp.initializers.add('flagrow-aqueduct', function(app) {\n    Tag.prototype.canAccessBoard = Model.attribute('canAccessBoard');\n    Tag.prototype.canUseBoard = Model.attribute('canUseBoard');\n    Tag.prototype.canManageBoard = Model.attribute('canManageBoard');\n    Tag.prototype.columns = Model.hasMany('columns');\n    Tag.prototype.boardSort = Model.attribute('boardSort') || null;\n    Tag.prototype.boardMaxItems = Model.attribute('boardMaxItems') || null;\n\n    Discussion.prototype.canAccessBoard = Model.attribute('canAccessBoard');\n    Discussion.prototype.canUseBoard = Model.attribute('canUseBoard');\n    Discussion.prototype.canManageBoard = Model.attribute('canManageBoard');\n    Discussion.prototype.assignedUsers = Model.hasMany('assignedUsers');\n    Discussion.prototype.assignedGroups = Model.hasMany('assignedGroups');\n\n    routes(app);\n\n    addsBoardToDiscussion();\n});\n","import Modal from 'flarum/components/Modal';\nimport tagLabel from 'flarum/tags/helpers/tagLabel';\nimport tagIcon from 'flarum/tags/helpers/tagIcon';\nimport highlight from 'flarum/helpers/highlight';\nimport classList from 'flarum/utils/classList';\nimport Button from \"flarum/components/Button\";\n\nexport default class AddColumnModal extends Modal {\n\n    title() {\n        return app.translator.trans('flagrow-aqueduct.forum.board.modals.add-column.title');\n    }\n    init() {\n        super.init();\n        this.for = this.props.tag;\n\n        this.tags = app.store.all('tags').filter(tag => {\n            return this.for.columns().indexOf(tag) == -1;\n        });\n\n        this.selected = m.prop('');\n        this.filter = m.prop('');\n        this.index = this.tags[0].id();\n        this.focused = false;\n    }\n\n    content() {\n        let tags = this.tags;\n        const filter = this.filter().toLowerCase();\n\n        tags = tags.filter(tag => {\n            return tag.id() != this.for.id() &&\n                (tag.position() === null || (tag.parent() && tag.parent().id() == this.for.id()));\n        })\n\n        // If the user has entered text in the filter input, then filter by tags\n        // whose name matches what they've entered.\n        if (filter) {\n            tags = tags.filter(tag => tag.name().substr(0, filter.length).toLowerCase() === filter);\n        }\n\n        return [\n          <div className=\"Modal-body\">\n            <div className=\"TagDiscussionModal-form\">\n              <div className=\"TagDiscussionModal-form-input\">\n                <div className={'TagsInput FormControl ' + (this.focused ? 'focus' : '')}>\n                  <span className=\"TagsInput-selected\">\n                    {this.selected() ?\n                            <span className=\"TagsInput-tag\" onclick={() => {\n                            this.selected('')\n                            this.onready();\n                          }}>\n                            {tagLabel(this.selected())}\n                          </span>\n                        : ''\n                    }\n                  </span>\n                  <input className=\"FormControl\"\n                    value={this.filter()}\n                    oninput={m.withAttr('value', this.filter)}\n                    onfocus={() => this.focused = true}\n                    onblur={() => this.focused = false}/>\n                </div>\n              </div>\n              <div className=\"TagDiscussionModal-form-submit App-primaryControl\">\n                {Button.component({\n                  type: 'submit',\n                  className: 'Button Button--primary',\n                  disabled: !this.selected(),\n                  icon: 'check',\n                  children: app.translator.trans('flarum-tags.forum.choose_tags.submit_button')\n                })}\n              </div>\n            </div>\n          </div>,\n\n          <div className=\"Modal-footer\">\n            <ul className=\"TagDiscussionModal-list SelectTagList\">\n              {tags\n                .filter(tag => filter || !tag.parent() || this.selected().id == tag.id())\n                .map(tag => (\n                  <li data-index={tag.id()}\n                    className={classList({\n                      pinned: tag.position() !== null,\n                      child: !!tag.parent(),\n                      colored: !!tag.color(),\n                      selected: this.selected() && this.selected().id == tag.id(),\n                      active: this.index === tag\n                    })}\n                    style={{color: tag.color()}}\n                    onmouseover={() => this.index = tag}\n                    onclick={() => this.selected(tag)}\n                  >\n                    {tagIcon(tag)}\n                    <span className=\"SelectTagListItem-name\">\n                      {highlight(tag.name(), filter)}\n                    </span>\n                    {tag.description()\n                      ? (\n                        <span className=\"SelectTagListItem-description\">\n                          {tag.description()}\n                        </span>\n                      ) : ''}\n                  </li>\n                ))}\n            </ul>\n          </div>\n        ];\n    }\n\n    className() {\n        return 'AddColumnModal';\n    }\n\n\n    onsubmit(e) {\n        e.preventDefault();\n\n        const board = this.for;\n        const column = this.selected();\n\n        app.request({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/board/' + board.slug() + '/columns/' + column.slug(),\n        }).then(results => {\n            let tag = app.store.pushPayload(results);\n\n            if (this.props.onsubmit) this.props.onsubmit(tag);\n\n            app.modal.close();\n\n            m.redraw.strategy('none');\n        });\n    }\n}\n","import sortable from 'html5sortable';\n\nimport Page from \"flarum/components/Page\";\nimport SplitDropdown from 'flarum/components/SplitDropdown';\nimport Button from 'flarum/components/Button';\nimport ItemList from 'flarum/utils/ItemList';\nimport AddColumnModal from '../modals/AddColumnModal';\nimport Card from '../components/Card';\nimport Column from '../components/Column';\n\nexport default class Board extends Page {\n    init() {\n        super.init();\n\n        this.bodyClass = 'Kanban--Board';\n\n        this.draggable = 'cards';\n        this.dragging = null;\n\n        this.refresh(true);\n    }\n\n\n    config(isInitialized, context) {\n        super.config(...arguments);\n\n        if (isInitialized) return;\n\n        app.setTitle('');\n        app.setTitleCount(0);\n\n        if (this.tag.canUseBoard() || this.tag.canManageBoard()) {\n            this.setDraggable();\n        }\n    }\n\n    view() {\n        return m('div', {\n            className: 'Board'\n        }, [\n            m('div', {\n                className: 'Board--Controls'\n            }, m('div', {className: 'container'}, [\n                Button.component({\n                    icon: 'fas fa-tag',\n                    className: 'Button',\n                    children: this.tag.name(),\n                    onclick: () => m.route('/t/' + this.tag.slug())\n                }),\n                this.controls().isEmpty() ? [] :\n                    SplitDropdown.component({\n                        children: this.controls().toArray(),\n                        icon: 'ellipsis-v',\n                        className: 'App-primaryControl',\n                        buttonClassName: 'Button--primary'\n                    }),\n                this.dragging && this.draggable === 'columns' ? [\n                    Button.component({\n                        icon: 'fas fa-lock',\n                        className: 'Button',\n                        children: app.translator.trans('flagrow-aqueduct.forum.board.buttons.fix-columns'),\n                        onclick: () => {\n                            this.draggable = 'cards';\n                            this.setDraggable();\n                        }\n                    })\n                ] : []\n            ])),\n            m('div', {\n                className: 'Board--List'\n            }, (this.loading ? [] : this.tags).map(tag => {\n                return Column.component({\n                    board: this.tag,\n                    tag,\n                    discussions: this.discussions[tag.slug()] || [],\n                    loading: this.loading,\n                    dragging: this.dragging,\n                    draggable: this.draggable,\n                    tags: this.tags\n                });\n            }))\n        ])\n    }\n\n    controls() {\n        let items = new ItemList;\n        let tag = this.tag;\n\n        if (tag.canManageBoard()) {\n            items.add('add-column', Button.component({\n                icon: 'fas fa-cog',\n                children: app.translator.trans('flagrow-aqueduct.forum.board.buttons.add-column'),\n                onclick: () => app.modal.show(new AddColumnModal({\n                    tag: tag,\n                    onsubmit: () => {\n                        this.refresh(true)\n                    }\n                }))\n            }));\n\n            if (this.draggable === 'cards') {\n                items.add('drag-columns', Button.component({\n                    icon: 'fas fa-lock-open',\n                    children: app.translator.trans('flagrow-aqueduct.forum.board.buttons.drag-columns'),\n                    onclick: () => {\n                        this.draggable = 'columns';\n                        this.setDraggable();\n                    }\n                }));\n            }\n        }\n\n        return items;\n    }\n\n    /**\n     * Clear and reload the discussion list.\n     *\n     * @public\n     */\n    refresh(clear = true) {\n        if (clear) {\n            this.loading = true;\n\n            // The primary tag for which we will show the board.\n            this.tag = app.store.getBy('tags', 'slug', m.route.param('tag'));\n\n            /**\n             * The discussions in the discussion list.\n             *\n             * @type {Discussion[]}\n             */\n            this.discussions = {};\n\n            this.tags = this.tag.columns() || [];\n        }\n\n        this.tags.sort((a, b) => {\n            return a.boardSort() - b.boardSort();\n        });\n\n        this.load().then(\n            results => {\n                app.store.pushPayload(results);\n\n                this.discussions = {};\n                this.parseResults(results.data);\n\n                this.setDraggable()\n            },\n            () => {\n                this.loading = false;\n                m.redraw();\n\n                this.setDraggable()\n            }\n        );\n    }\n\n    /**\n     * Parse results and append them to the discussion list.\n     *\n     * @param {Discussion[]} results\n     * @return {Discussion[]}\n     */\n    parseResults(results) {\n        this.tags.forEach(tag => {\n\n            this.discussions[tag.slug()] = [];\n\n            results.forEach(discussion => {\n                discussion = app.store.getById(discussion.type, discussion.id);\n\n                if (discussion.tags().map(tag => tag.id()).indexOf(tag.id()) != -1) {\n                    this.discussions[tag.slug()].push(discussion);\n                }\n            });\n        })\n\n        this.loading = false;\n\n        m.lazyRedraw();\n\n        return results;\n    }\n\n    /**\n     * Load discussions based on the tags.\n     */\n    load() {\n        return app.request({\n            method: 'get',\n            url: app.forum.attribute('apiUrl') + '/board/' + this.tag.slug(),\n        });\n    }\n\n    /**\n     * Listens to dragging event and updates the sorting of the columns.\n     */\n    setDraggable() {\n        let sorted = [];\n\n        if (! this.dragging && this.draggable === 'columns') {\n            sorted = sortable('.Board--List', {\n                items: '.Board--Column',\n                handle: '.Board--Header',\n                placeholder: '<div class=\"Board--Column Placeholder\"></div>',\n                forcePlaceholderSize: true\n            });\n\n            if (sorted.length > 0) {\n                this.sorted[0].addEventListener('sortupdate', (e) => {\n                    const sorting = $(e.target).find('.Board--Column').map(function () {\n                        return $(this).attr('slug');\n                    }).get();\n\n                    this.updateColumnSorting(sorting);\n                });\n            }\n        } else if (this.draggable === 'columns') {\n            sortable('.Board--List');\n        } else {\n            sortable('.Board--List', 'destroy');\n        }\n\n        this.dragging = (this.dragging === null && sorted.length > 0) || this.dragging !== null;\n    }\n\n    updateColumnSorting(sorting) {\n        return app.request({\n            method: 'post',\n            url: app.forum.attribute('apiUrl') + '/board/' + this.tag.slug() + '/sorting',\n            data: sorting\n        }).then(results => {\n            app.store.pushPayload(results);\n            m.redraw()\n\n            this.setDraggable()\n        })\n    }\n\n\n}\n","import Board from './pages/Board';\n\nexport default function (app) {\n    app.routes['flagrow.kanban.board'] = {path: '/board/:tag', component: Board.component()};\n}\n","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['components/SplitDropdown'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/avatar'];","module.exports = flarum.core.compat['helpers/highlight'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['models/Discussion'];","module.exports = flarum.core.compat['tags/helpers/tagIcon'];","module.exports = flarum.core.compat['tags/helpers/tagLabel'];","module.exports = flarum.core.compat['tags/models/Tag'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['utils/classList'];"],"sourceRoot":""}